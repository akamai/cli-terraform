resource "akamai_appsec_malware_policy" "fms_configuration_1" {
  config_id = local.config_id
  malware_policy = jsonencode(
    {
      "contentTypes" : [
        {
          "name" : "text/value"
        },
        {
          "encodedContentAttributes" : [
            {
              "encoding" : [
                "base64"
              ],
              "path" : "image.imagePath"
            }
          ],
          "name" : "application/json"
        }
      ],
      "description" : "Malware configuration details",
      "hostnames" : [
        "test.akamai.com",
        "sample.akamai.com"
      ],
      "name" : "FMS Configuration 1",
      "paths" : [
        "/base-path",
        "/test"
      ]
    }
  )
}

resource "akamai_appsec_malware_policy" "fms_configuration_2" {
  config_id = local.config_id
  malware_policy = jsonencode(
    {
      "contentTypes" : [
        {
          "name" : "text/value"
        },
        {
          "encodedContentAttributes" : [
            {
              "encoding" : [
                "base64"
              ],
              "path" : "image.imagePath"
            }
          ],
          "name" : "application/json"
        }
      ],
      "description" : "Malware configuration details",
      "hostnames" : [
        "test.akamai.com"
      ],
      "name" : "FMS Configuration 2",
      "paths" : [
        "/base-path"
      ]
    }
  )
}

resource "akamai_appsec_malware_policy" "fms_configuration_3" {
  config_id = local.config_id
  malware_policy = jsonencode(
    {
      "contentTypes" : [
        {
          "name" : "text/value"
        },
        {
          "encodedContentAttributes" : [
            {
              "encoding" : [
                "base64"
              ],
              "path" : "image.imagePath"
            }
          ],
          "name" : "application/json"
        }
      ],
      "description" : "Malware configuration details",
      "hostnames" : [
        "sample.akamai.com"
      ],
      "name" : "FMS Configuration 3",
      "paths" : [
        "/test"
      ]
    }
  )
}

