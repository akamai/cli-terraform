{{ range .SecurityPolicies -}}
{{ $policyName := escapeName .Name -}}

{{ if .MalwarePolicyActions -}}
// Malware Policy Actions
{{ range .MalwarePolicyActions -}}
resource "akamai_appsec_malware_policy_action" "{{ $policyName}}_{{ getMalwareNameByID $ .MalwarePolicyID }}" {
    config_id          = local.config_id
    security_policy_id = akamai_appsec_malware_protection.{{ $policyName}}.security_policy_id
    malware_policy_id  = akamai_appsec_malware_policy.{{ getMalwareNameByID $ .MalwarePolicyID }}.malware_policy_id
    action             = "{{ .Action }}"
    unscanned_action   = "{{ .UnscannedAction }}"
}

{{ end -}}
{{ end -}}

{{ end -}}
